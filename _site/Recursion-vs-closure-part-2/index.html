<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <title>Recursion Functional vs Closure Part II &#8211; Kwyn Meagher</title> <meta name="description" content="Background"> <meta name="keywords" content="recursion, algorithms, optimization, perfJS, JavaScript"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="http://localhost:4000/images/the-golden-ratio.jpg"> <meta name="twitter:title" content="Recursion Functional vs Closure Part II"> <meta name="twitter:description" content="Background"> <meta name="twitter:site" content="@HarleyKwyn"> <meta name="twitter:creator" content="@HarleyKwyn"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Recursion Functional vs Closure Part II"> <meta property="og:description" content="Background"> <meta property="og:url" content="http://localhost:4000/Recursion-vs-closure-part-2/"> <meta property="og:site_name" content="Kwyn Meagher"> <meta property="og:image" content="http://localhost:4000/images/halve.png"> <link rel="canonical" href="http://localhost:4000/Recursion-vs-closure-part-2/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Feed --> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Kwyn Meagher" /> <!-- Favicons --> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- CSS --> <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css"> <!-- Left Block Image for Posts --> <style type="text/css"> #posts.inner-post-page .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/the-golden-ratio.jpg) no-repeat;background-size: cover;} </style> <!-- Left Block Images for Home and Pages --> <style type="text/css"> #posts .block-left {background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(http://localhost:4000/images/unsplash-image-10.jpg) no-repeat;background-size: cover, cover;} .block-left {background: linear-gradient(rgba(44,45,51,0.9), rgba(44,45,51,0.9)), url(http://localhost:4000/images/home.png) no-repeat;background-size: cover;} </style> </head> <body id="posts" class="inner-post-page"> <div class="block-left"> <div class="content"> <a href="http://localhost:4000" class="logo"><img src="http://localhost:4000/images/halve.png"></a> <div class="post-title-section"> <div class="section-line">Posts <em>/</em></div> <h1 class="section-title">Recursion Functional vs Closure Part II </h1> <ul class="tags"> <li><a href="http://localhost:4000/tags#recursion">recursion</a></li> <li><a href="http://localhost:4000/tags#algorithms">algorithms</a></li> <li><a href="http://localhost:4000/tags#optimization">optimization</a></li> <li><a href="http://localhost:4000/tags#perfJS">perfJS</a></li> <li><a href="http://localhost:4000/tags#JavaScript">JavaScript</a></li> </ul> <div class="section-line reverse"><a href="http://localhost:4000/posts">Back to posts</a> <em>/</em></div> </div> </div> </div> <div class="block-right"> <div class="share-buttons"> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> &copy; 2016 <a href="https://plus.google.com/+KwynMeagher?rel=author"> Kwyn Alice Meagher </a>. </div> <a href="../posts.html" title="posts" class="posts-menu-icon"></a> <!-- <a title="projects" class="projects-menu-icon"> <span></span> </a> --> <div class="inner-post content"> <div class="date-highlight">28 Jan 2014</div> <h2 id="background">Background</h2> <p>To continue our discussion from my <a href="http://harleykwyn.com/Recursion-closure-and-iteration/">previous post</a> I’ve decided to run another head ot head test with a functional recursive implementation and a closure scope recursive implementation.</p> <p>A quick review of the differences between implementations</p> <ol> <li><a href="http://en.wikipedia.org/wiki/Recursion">Recursion</a> with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Closures">closure variable</a> to keep track of answers</li> <li><a href="http://en.wikipedia.org/wiki/Recursion#Functional_recursion">Functional recursion</a> which passes in all variables with each recursive call.</li> <li>Iteration which uses a while loop to iterate over all of the possibilities. We’ll leave this one out of the fight for now.</li> </ol> <h2 id="implementations">Implementations</h2> <p>Ideally both of the following implementations should be executed in 0(n) time. This is mainly to test V8’s (chrome’s javascript engine) handling of functional recursion and closure scope recursion.</p> <p>Each of these implementations references a javascript object with keys for all of the numbers and their associated letters.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">phoneDigitsToLetters</span> <span class="o">=</span> <span class="p">{</span>
  <span class="mi">0</span><span class="p">:</span> <span class="s1">'0'</span><span class="p">,</span>
  <span class="mi">1</span><span class="p">:</span> <span class="s1">'1'</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">'ABC'</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">'DEF'</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">'GHI'</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">'JKL'</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">'MNO'</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">'PQRS'</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">'TUV'</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">'WXYZ'</span>
<span class="p">};</span></code></pre></figure> <h3 id="functional-recursion">Functional Recursion</h3> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">telephoneWordsFunctional</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">digitString</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">possibleWords</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">possibleWords</span> <span class="o">=</span> <span class="nx">possibleWords</span> <span class="o">||</span> <span class="p">[];</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">digitString</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">){</span>
    <span class="nx">possibleWords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">word</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">word</span> <span class="o">=</span> <span class="nx">word</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">letters</span> <span class="o">=</span> <span class="nx">phoneDigitsToLetters</span><span class="p">[</span><span class="nx">digitString</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
  <span class="nx">digitString</span> <span class="o">=</span> <span class="nx">digitString</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">letters</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="nx">telephoneWordsFunctional</span><span class="p">(</span><span class="nx">digitString</span><span class="p">,</span> <span class="nx">word</span> <span class="o">+</span> <span class="nx">letters</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">possibleWords</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">possibleWords</span><span class="p">;</span>
<span class="p">};</span></code></pre></figure> <p>###Closure Recursion</p> <p>The key difference here is the subroutine we’re wrapping into line 3. This places the possibleWords array outside the scope of the subroutine function which behaves much like the functional recursive implementation above.</p> <p>This allows the v8 javascript engine to clean up the function calls after they’re finished instead of leaving them open. Scopes in Javascript will not close until they are no longer referenced and if we have to continually pass all of our arguments along, v8 will have to keep all of those instances open. <a href="https://medium.com/p/8eee8afb41df">This</a> blog post explains this well and how to address this if you want to continue to use functional programming.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">telephoneWordsClosure</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">digitString</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">possibleWords</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="kd">var</span> <span class="nx">subroutine</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">digitString</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">index</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="nx">digitString</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>
      <span class="nx">possibleWords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">word</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">newWord</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">letters</span> <span class="o">=</span> <span class="nx">phoneDigitsToLetters</span><span class="p">[</span><span class="nx">digitString</span><span class="p">[</span><span class="nx">index</span><span class="p">]]</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">letters</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span> <span class="o">++</span><span class="p">){</span>
      <span class="nx">newWord</span> <span class="o">=</span> <span class="nx">word</span> <span class="o">+</span> <span class="nx">letters</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="nx">subroutine</span><span class="p">(</span><span class="nx">digitString</span><span class="p">,</span> <span class="nx">newWord</span><span class="p">,</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="nx">subroutine</span><span class="p">(</span><span class="nx">digitString</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">possibleWords</span><span class="p">;</span>
<span class="p">};</span></code></pre></figure> <h2 id="perfjs-test-results">PerfJS test results</h2> <p><img src="/images/jsPerfTable.png" alt="jsPerf Table" /></p> <p><img src="/images/jsPerfBarChart.png" alt="jsPerf Bar Chart" /></p> <p>On my computer using chrome the results of the <a href="http://jsperf.com/permute-telephone-letters">perfJS spec</a> I created show that once again the recursive solution is the most optimal. Closure recursion is approximately as the same difference as last time.</p> <p>I encourage you to run <a href="http://jsperf.com/tree-map-kwyn">my perfJS</a> on your own computer and in different browsers and report back to me what you find!</p> <br> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a> <a href="https://plus.google.com/share?url=http://localhost:4000/Recursion-vs-closure-part-2/" class="btn btn_google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a> &copy; 2016 <a href="https://plus.google.com/+KwynMeagher?rel=author"> Kwyn Alice Meagher </a>. <nav class="pagination"> <a href="http://localhost:4000/slick-jekyll-themes-and-github-pages/" class="pagination_pager" title="Slick jekyll themes + Github Pages ">previous</a> <a href="http://localhost:4000/google-comments-in-jekyll/" class="pagination_pager" title="Google Comments in Jekyll ">next</a> </nav> <div id="comments"></div> <script> window.onLoadCallback = function() { gapi.comments.render('comments', { href: window.location, width: '624', first_party_property: 'BLOGGER', view_type: 'FILTERED_POSTMOD' }); } </script> </div> </div> <!-- JS --> <script src="http://localhost:4000/assets/js/main.min.js"></script> <script> // Defines the configuration options, these must be set before you load // the platform.js file. window.___gcfg = { lang: 'en-US', parsetags: 'explicit' // DS?: can the onload param be removed from the line below and added here? // E.g., 'explicit','onload' } </script> <script src="https://apis.google.com/js/platform.js" async defer></script> <div class="overlay"> <ul class="projects-menu"> <li style="background:url(http://taylantatli.me/Halve/images/halve-home-image.png) center center no-repeat;"> <a href="http://taylantatli.me/Halve" class="inactive" target="_blank" rel="nofollow external"> <span> Halve Jekyll Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://cloud.githubusercontent.com/assets/754514/14509720/61c61058-01d6-11e6-93ab-0918515ecd56.png) center center no-repeat;"> <a href="http://taylantatli.me/Moon" target="_blank" rel="nofollow external"> <span> Moon Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Ramme/master/assets/img/screenshot-post.png) center center no-repeat;"> <a href="http://taylantatli.me/Ramme" target="_blank" rel="nofollow external"> <span> Ramme Jekyll Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Daisy-Pelican-Theme/master/Preview-1.png) center center no-repeat;"> <a href="http://taylantatli.me/Daisy-Pelican-Theme/" target="_blank" rel="nofollow external"> <span> Daisy Pelican Theme </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/Block-Icon-Theme/master/Preview.png) center center no-repeat;"> <a href="https://github.com/TaylanTatli/Block-Icon-Theme" class="inactive" target="_blank" rel="nofollow external"> <span> Block Icon Theme <br><em>in progress</em> </span> </a> </li> <li style="background:url(https://raw.githubusercontent.com/TaylanTatli/StartPage/master/preview.png) center center no-repeat;"> <a href="http://taylantatli.me/StartPage/" class="inactive" target="_blank" rel="nofollow external"> <span> Start Page <br><em>in progress</em> </span> </a> </li> </ul> </div> </body> </html>
